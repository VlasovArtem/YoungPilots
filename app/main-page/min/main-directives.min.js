var app=angular.module("main.directives",[]);app.directive("broadcast",["$timeout","BroadcastLive","$route","Broadcast","$filter",function(b,a,e,c,d){return{restrict:"A",link:function(s,k,q){var i=60*1000;var j,l;c.get(function(t){j=d("dateMillis")(t.date.startDate,t.date.timezone)});var n=function(t,u){return t+(u*60000)};var m=function(B){if(_.isNull(j)||_.isUndefined(j)){throw new Error("Broadcast date is undefined")}var w=[["d","day","days"],["h","hour","hours"],["m","minute","minutes"],["s","second","seconds"]];var z=null;_.some(w,function(C){if(_.contains(C,B)){z=C[1];return true}return false});var x=j-l;var t=null;switch(z){case"day":var y=24*60*60*1000;t=x/y;break;case"hour":var u=60*60*1000;t=x/u;break;case"minute":var A=60*1000;t=x/A;break;case"second":var v=1000;t=x/v;break}return t};var r=true;var h=function(){if(m("d")<=1&&m("h")>3){i=3*60*60*1000}else{if(m("h")<=3&&m("m")>60){i=60*60*1000}else{if(m("m")<=60&&m("m")>10){i=10*60*1000}else{if(m("m")<=10&&m("s")>0){i=60*1000}else{if(m("s")<=0){a.get(function(){k.addClass("live");b.cancel(o);i=60*1000;r=false;f=b(g,2*60*60*1000);console.log(i+" (default: 86400000")},function(){if(m("m")<-60){j=null;o=b(p,60*60*1000);r=false;console.log(new Date(l)+" - Broadcast is not starting")}})}else{i=24*60*60*1000}}}}}};var g=function(){a.get(function(){},function(){e.reload()});f=b(g,2*60*60*1000)};var f=null;var p=function(){var t=new Date();l=n(t.getTime(),t.getTimezoneOffset());if(j<l){s.broadcastDate=null;i=2*60*60*1000}else{h()}o=b(t,i)};var o=b(p,i)}}}]);app.directive("countdown",["$timeout","$filter",function(a,b){return{restrict:"C",scope:{date:"=",offset:"="},link:function(o,f,l){var e=b("convertDate")(o.date,o.offset);var c=new Date().getTime();var g=function(){c=new Date().getTime()};var h=24*60*60*1000,m=60*60*1000,d=60*1000,j=1000;var n=function(){var s=e-c;var p=Math.floor(s/h),q=Math.floor((s-(p*h))/m),t=Math.floor((s-(p*h+q*m))/d),r=Math.floor((s-(p*h+q*m+t*d))/j);o.left={day:p,hour:q,minute:t,second:r}};var k=function(){g();n();i=a(k,j)};var i=a(k,j)},template:'<span>Next conference: <i>Days: {{left.day}}, <span ng-if="left.hour < 10">0</span>{{left.hour}}:<span ng-if="left.minute < 10">0</span>{{left.minute}}:<span ng-if="left.second < 10">0</span>{{left.second}}</i></span>'}}]);app.directive("popup",function(){return{restrict:"A",scope:{popupContent:"=",textContent:"@"},link:function(d,c,b){if(!angular.isUndefined(d.popupContent)||!angular.isUndefined(d.textContent)){var e=d.popupContent!=null&&(d.popupContent.length>110||!angular.isUndefined(d.textContent))?d.popupContent:d.textContent;if(!angular.isUndefined(e)){var a={content:e,trigger:"hover",placement:"bottom",container:"body"};$(c).popover(a)}}}}});app.directive("contacts",function(){return{restrict:"E",require:"^ngModel",link:function(d,c,b){var a=d.$eval(b.ngModel);var e={github:"style/image/socials/github.png",twitter:"style/image/socials/twitter.png",linkedin:"style/image/socials/linkedin.png"};d.personalData=a.lastname!=null?(a.firstname+", "+a.lastname):a.firstname;d.contactSocials={};_.each(a.socials,function(g,f){d.contactSocials[e[f]]=g})},template:'<div class="main-data"><div class="outer-contact-block"><div class="contact-block"> <img ng-src="{{contact.img}}" class="contact-img img-circle"/> <div> <span ng-if="personalData" ng-bind="personalData" class="contact-personal-data"></span><br/> <span class="glyphicon glyphicon-map-marker"></span><span ng-bind="contact.info.location"></span><hr class="style"/> <span>{{contact.info.position}} at <a href="{{contact.info.jobWebSite}}">{{contact.info.job}}</a></span> </div> </div> <p ng-if="contact.info.webSite"><span class="glyphicon glyphicon-link"></span><a href="{{contact.info.webSite}}">{{contact.info.webSite}}</a></p></div><p class="note" ng-if="contact.info.note && !mobile">{{contact.info.note}}</p> </div> <div class="socials"> <span ng-repeat="(key, value) in contactSocials"> <a href="{{value}}" target="_blank"><img ng-src="{{key}}"/></a> </span> </div>'}});